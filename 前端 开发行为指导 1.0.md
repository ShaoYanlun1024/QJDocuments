# 前端开发行为指导 1.0

修订人|版本号
-|-
刘秋月|1.0

## 一、设计背景
> 前端项目基于vue.js框架，实现组件化编程，完美的单页面展示。
> 但是，基于vue-cli脚手架搭建的项目中，.vue文件中的业务逻辑与组件耦合严重，所以在项目中实现了用vuex完成网络请求并且记录数据状态，外层api文件封装请求地址以及请求方式。
> 组件内部只需要做数据的处理和展示就可以了。

## 二、 web端目录结构
- src 主要业务代码
    - api 接口层
    - assets 公共工具类
    - components 组件以及页面
    - model data中的对象
    - mixins 面向对象抽离出的公共事件(主要为了使用混合)
    - pages 页面
    - router 路由
    - store vuex实现(包括数据请求)
        - list 模块化文件夹
        - index.js vuex配置文件
        - mutationTypes.js 更改状态常量
    - App.vue 根页面
    - main.js 全局配置文件

## 三、 项目代码逻辑实现
### 1. vuex模块化在项目中的配置
- 在src下新建文件夹store，在main.js中，import新建的sotre文件夹，在new Vue()中添加store。
- 在store文件夹中新建index.js，导入(import)vue和vuex，然后引用vuex。export default new Vuex.Store()导出写好的模块化文件，详细配置参考demo中的源码。

### 2. 优雅的组件GDialog.vue
GDialog组件实现组件资源回收以及数据清除，他作为弹窗组件与列表组件的中间层，不需要修改组件内部的东西，只需要根据需要，调里面的方法，以及传数据就可以。

### 3. 前端架构使用
- api.js文件里面写axios数据请求，如果项目比较大的话，可以考虑api层按照领域去划分。
- store文件夹里面的modules也可以按照业务领域去划分，一个.js文件里面实现增删改查的接口事件。
- 所有.vue组件文件，只实现页面展示数据，和组件之间需要传递的数据。鉴于现在vuex与v-model双向绑定之间还有一些bug，所以不建议表单数据与vuex进行交互。这点需要注意一下。

### 4. 具体实现
JournalDemo中，只是实现了简单增删改查，下面以列表展示和新增为例，讲讲项目中具体实现这个功能的逻辑。
- 在src/components中新建一个表格展示的组件和新增表单的组件(具体代码参照源码)，表格展示的组件需要写编辑和删除按钮的点击事件，并且将选中的一行数据进行传出。
- 新增组件可能也会当做修改组件去用，也就是组件的复用，可能一个页面两个事件，用的是同一个组件，所以在提交的时候，需要判断一下表单数据来源，看是走新增的方法还是修改的。
- .vue文件中，需要用this.$store.dispatch去请求vuex中actions的提交的方法，并且修改mutation里面的数据状态，然后通过getter返回给.vue文件，实现一个数据源的管理。

## 四、开发注意事项
1. 所有需要在全局引入css文件的，将css文件在main.js文件引入。这关系到项目正式构建发布的时候，webpack打包css的顺序。而vue项目的入口文件是main.js，所以项目打包的时候，webpack会先打包main.js相关的所有文件。
2. 所有需要引入的css文件全部采用小写+下划线的方式。
3. 所有组件的划分，嵌套层数不得超过**3**层，也就是说开发过程中，组件的拆分尽量保证嵌套的层数少一些，但是页面的代码行数不要超过500行。

## 五、前端项目构建上线
1. 在正式环境中，web前端的项目先使用npm run build执行打包命令，在项目目录中会生成一个dist文件夹，里面是生成的包括html+css+js的静态文件。
2. 运维会根据打包生成的这些静态页发布到服务器上。
