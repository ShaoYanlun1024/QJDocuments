# 消息队列规范

整理 | 版本 | 日期 | 描述
--- | --- | --- | ---  
孙靖武 | 0.01 | 2019.04.29 | 初稿

## 命名
q:队列   
e:交换机

队列名称：q.服务名     
交换机名称: e.交换机类型.服务名

## 日志
- 生产者：记录已发送消息
- 消费者：记录接收的消息是否正常消费

## 消息持久化
- 消息中间件：消息代理对发送到的消息持久化

> 确保发送到消息代理的消息，不会因为消息代理服务宕机而造成消息丢失

## 确认机制
- 消息生产者：rabbitmq(事务机制、确认机制)

> 保证生产者将消息发送到消息代理，可进行消息补偿重发操作


## 应答机制
- 自动
- 手动，根据业务需求，对异常消费的消息进行丢弃（格式不对）或重新入队列

> 推荐手动，确保消息代理的消息被正常消费，可二次消费

## 消息投递
- 消费者应设置每次从消息代理提取的消息数量

> 如果完全不配置，消息代理会尽可能快速地
发送队列中的所有消息到消费端，
从而极有可能导致OOM或者导致服务器内存不足影响其它进程的正常运行
